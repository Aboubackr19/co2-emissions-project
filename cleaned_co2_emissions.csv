# Reconnect to the database
conn = sqlite3.connect('co2_emissions.db')
cursor = conn.cursor()

# Query all data from the emissions table
cursor.execute("SELECT * FROM emissions")
data = cursor.fetchall()

# Convert the data into a pandas DataFrame
import pandas as pd
df_cleaned = pd.DataFrame(data, columns=['ID', 'Country_ID', 'CO2_Emissions', 'Year_Change', 'Population', 'Per_Capita', 'Share_of_World'])

# Save the cleaned data to CSV
df_cleaned.to_csv('cleaned_co2_emissions.csv', index=False)

# Close the connection
conn.close()
